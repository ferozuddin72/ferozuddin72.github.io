var sowb=window.sowb||{};jQuery((function(s){sowb.setupCarousel=function(){s(".sow-carousel-wrapper").each((function(){var e=s(this);direction=e.attr("dir"),$items=e.find(".sow-carousel-items"),$widget=e.parent().parent(),instanceHash=$widget.find('input[name="instance_hash"]').val(),numItems=$items.find(".sow-carousel-item").length,totalPosts=e.data("post-count"),complete=numItems===totalPosts,fetching=!1,page=1,itemWidth=$items.find(".sow-carousel-item").outerWidth(!0),$items.not(".slick-initialized").slick({arrows:!1,infinite:!1,rows:0,rtl:"rtl"==direction,waitForAnimate:!1,touchThreshold:20,variableWidth:!0,responsive:[{breakpoint:carouselBreakpoints.tablet_portrait,settings:{slidesToScroll:2,slidesToShow:2}},{breakpoint:carouselBreakpoints.mobile,settings:{slidesToScroll:1,slidesToShow:1}}]}),$widget.find(".sow-carousel-previous, .sow-carousel-next").on("click",(function(t){t.preventDefault(),$items=e.find(".sow-carousel-items");const i=Math.ceil($items.outerWidth()/itemWidth),o=numItems-i+1;complete||$items.slick("slickCurrentSlide")+i>=numItems-1&&(fetching||(fetching=!0,page++,$items.slick("slickAdd",'<div class="sow-carousel-item sow-carousel-loading"></div>'),s.get(e.data("ajax-url"),{query:e.data("query"),action:"sow_carousel_load",paged:page,instance_hash:instanceHash},(function(s,t){$items.find(".sow-carousel-loading").remove(),$items.slick("slickAdd",s.html),numItems=e.find(".sow-carousel-item").length,complete=numItems===totalPosts,fetching=!1})))),s(this).hasClass("sow-carousel-next")?$items.slick("slickCurrentSlide")>=o?e.data("loop-posts-enabled")&&!fetching&&$items.slick("slickGoTo",0):$items.slick("slickNext"):s(this).hasClass("sow-carousel-previous")&&(e.data("loop-posts-enabled")&&0==$items.slick("slickCurrentSlide")?$items.slick("slickGoTo",o-(complete?0:1)):$items.slick("slickPrev"))}))})),s(window).resize((function(){window.matchMedia("(min-width: "+carouselBreakpoints.tablet_portrait+"px) and (max-width: "+carouselBreakpoints.tablet_landscape+"px) and (orientation: landscape)").matches&&(s(".sow-carousel-items").slick("slickSetOption","slidesToShow",3),s(".sow-carousel-items").slick("slickSetOption","slidesToScroll",3))}))},sowb.setupCarousel(),s(sowb).on("setup_widgets",sowb.setupCarousel)})),window.sowb=sowb;